<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Peso Converter</title>
    <style>
        :root { --primary: #28a745; --secondary: #007bff; --error: #dc3545; --bg: #f8f9fa; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .card { background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 400px; }
        h2 { text-align: center; margin-bottom: 1.5rem; color: #333; }
        .group { margin-bottom: 1rem; }
        label { font-size: 0.85rem; font-weight: bold; color: #666; display: block; margin-bottom: 5px; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; box-sizing: border-box; }
        
        /* Manual Rate Section */
        #manual-section { background: #fff3f3; padding: 15px; border-radius: 8px; border: 1px dashed var(--error); display: none; margin-bottom: 15px; }
        
        /* Fixed Manual Toggle Layout */
        .manual-control-wrapper { display: flex; align-items: center; margin-bottom: 15px; cursor: pointer; width: fit-content; }
        .manual-control-wrapper input[type="checkbox"] { width: auto; margin-right: 10px; cursor: pointer; }
        .manual-control-wrapper label { margin-bottom: 0; cursor: pointer; color: var(--secondary); display: inline-block; }

        .btn-row { display: flex; gap: 10px; margin-top: 15px; }
        button { flex: 1; padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .swap-btn { background: #6c757d; color: white; }
        .convert-btn { background: var(--primary); color: white; flex: 2; }
        button:hover { opacity: 0.9; }

        #result-box { margin-top: 20px; padding: 15px; background: #e9ecef; border-radius: 8px; text-align: center; }
        .result-text { font-size: 1.8rem; font-weight: bold; color: var(--secondary); display: block; }
        .rate-info { font-size: 0.8rem; color: #777; margin-top: 5px; }
    </style>
</head>
<body>

<div class="card">
    <h2 id="title">Peso to USD</h2>
    
    <div class="group">
        <label id="input-label">Amount in Pesos:</label>
        <input type="number" id="amount" placeholder="0.00" value="100">
    </div>

    <div class="group">
        <label>Currency Type:</label>
        <select id="pesoType" onchange="updateUI()">
            <option value="MXN">Mexican Peso (MXN)</option>
            <option value="PHP">Philippine Peso (PHP)</option>
            <option value="CLP">Chilean Peso (CLP)</option>
            <option value="COP">Colombian Peso (COP)</option>
            <option value="ARS">Argentine Peso (ARS)</option>
        </select>
    </div>

    <div class="manual-control-wrapper" onclick="document.getElementById('manualMode').click()">
        <input type="checkbox" id="manualMode" onchange="toggleManual(); event.stopPropagation();">
        <label for="manualMode">üõ†Ô∏è Manual Exchange Rate</label>
    </div>

    <div id="manual-section">
        <label>Set Custom Rate (1 Unit = ?):</label>
        <input type="number" id="manualRate" step="0.0001" placeholder="e.g. 0.051">
    </div>

    <div class="btn-row">
        <button class="swap-btn" onclick="swap()">‚áÑ Swap</button>
        <button class="convert-btn" onclick="convert()">Convert</button>
    </div>

    <div id="result-box">
        <span class="result-text" id="output-val">$0.00</span>
        <span class="rate-info" id="rate-text">Enter amount and convert</span>
    </div>
</div>

<script>
    let isPesoToUsd = true;

    function toggleManual() {
        const section = document.getElementById('manual-section');
        section.style.display = document.getElementById('manualMode').checked ? 'block' : 'none';
    }

    function updateUI() {
        const peso = document.getElementById('pesoType').value;
        document.getElementById('title').innerText = isPesoToUsd ? `${peso} to USD` : `USD to ${peso}`;
        document.getElementById('input-label').innerText = isPesoToUsd ? `Amount in ${peso}:` : `Amount in USD:`;
    }

    function swap() {
        isPesoToUsd = !isPesoToUsd;
        updateUI();
        convert();
    }

    async function convert() {
        const amount = parseFloat(document.getElementById('amount').value);
        const peso = document.getElementById('pesoType').value;
        const manualMode = document.getElementById('manualMode').checked;
        const manualRate = parseFloat(document.getElementById('manualRate').value);
        
        const outputVal = document.getElementById('output-val');
        const rateText = document.getElementById('rate-text');

        if (manualMode) {
            if (isNaN(manualRate)) {
                alert("Please enter a manual rate.");
                return;
            }
            processConversion(amount, manualRate, "Manual Override");
        } else {
            const base = isPesoToUsd ? peso : "USD";
            const target = isPesoToUsd ? "USD" : peso;
            
            try {
                const response = await fetch(`https://api.frankfurter.dev/v1/latest?base=${base}&symbols=${target}`);
                if (!response.ok) throw new Error("API Down");
                const data = await response.json();
                processConversion(amount, data.rates[target], "Live Rate");
            } catch (error) {
                alert("Connection failed. Switching to manual mode.");
                document.getElementById('manualMode').checked = true;
                toggleManual();
            }
        }
    }

    function processConversion(amount, rate, source) {
        const peso = document.getElementById('pesoType').value;
        const total = (amount * rate).toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
        const targetLabel = isPesoToUsd ? "USD" : peso;
        const baseLabel = isPesoToUsd ? peso : "USD";

        document.getElementById('output-val').innerText = (targetLabel === "USD" ? "$" : "") + total + " " + targetLabel;
        document.getElementById('rate-text').innerText = `${source}: 1 ${baseLabel} = ${rate.toFixed(4)} ${targetLabel}`;
    }
</script>

</body>
</html>
